!function(e,t,n){var r,a=!1,o=!1,i=1e3;n.prototype.add||(n.prototype.add=function(e){return this.addAll([e])}),n.prototype.addAll||(n.prototype.addAll=function(e){function n(e){this.name="NetworkError",this.code=19,this.message=e}var r=this;return n.prototype=Object.create(Error.prototype),Promise.resolve().then(function(){if(arguments.length<1)throw new TypeError;return e=e.map(function(e){return e instanceof Request?e:String(e)}),Promise.all(e.map(function(e){"string"==typeof e&&(e=new Request(e));var r=new URL(e.url).protocol;if("http:"!==r&&"https:"!==r)throw new n("Invalid scheme");return t(e.clone()).catch(function(e){throw e})}))}).then(function(t){return Promise.all(t.map(function(t,n){return r.put(e[n],t)}))}).then(function(){})}),CacheStorage.prototype.match||(CacheStorage.prototype.match=function(e,t){var n=this;return this.keys().then(function(r){var a;return r.reduce(function(r,o){return r.then(function(){return a||n.open(o).then(function(n){return n.match(e,t)}).then(function(e){return a=e})})},Promise.resolve())})}),e.addEventListener("install",function(t){t.waitUntil(f().then(function(){e.skipWaiting()}).catch(function(){e.skipWaiting()}))}),e.addEventListener("activate",function(t){t.waitUntil(e.clients.claim())});var c,s,u=function(e){return new Promise(function(n,r){if(!a||!o||e&&e>o){var i=!a;f().then(function(){i&&n(a?a:!1)}).catch(function(){i&&n(!1)})}else if(!c&&o<h()-300){c=!0;var s=new Request("./abtf-pwa-config.json?"+Math.round(Date.now()/1e3),{method:"HEAD",mode:"no-cors"});t(s).then(function(e){c=!1;var t=!0;if(e&&e.ok){var n=l(e.headers.get("last-modified"));n&&n<=o&&(t=!1)}t&&f()}).catch(function(e){c=!1,f()})}else n(a)}).catch(function(e){setTimeout(function(){throw e})})},f=function(){return c?Promise.resolve():(c=!0,t("./abtf-pwa-config.json?"+Math.round(Date.now()/1e3),{mode:"no-cors"}).then(function(e){if(c=!1,e&&e.ok&&e.status<400)return e.json().then(function(e){if(e){e instanceof Array&&(e={policy:e}),e.policy&&(a=e.policy,o=h());var t=[];e.policy&&e.policy.forEach(function(e){e.offline&&-1===t.indexOf(e.offline)&&t.push(e.offline)}),e.preload&&e.preload.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),t.forEach(function(e){b(e)})}});throw a=!1,new Error("service worker config not found: ./abtf-pwa-config.json")}).catch(function(e){c=!1,a=!1,setTimeout(function(){throw e})}))},h=function(){return Math.round(Date.now()/1e3)},l=function(e){if(e)return isNaN(parseInt(e))?(e=Date.parse(e),isNaN(e)?void 0:Math.round(e/1e3)):e},d=/^\/(.*)\/([gimuy]+)?$/,p=function(e){var t=e.match(d);if(t){try{var n=new RegExp(t[1],t[2])}catch(e){}return n||!1}},v=!1,m=!1,w=function(){if(s)try{clearTimeout(s)}catch(e){}s=setTimeout(g,500)},g=function(){m||(!v||v<h()-10)&&(m=!0,v=h(),caches.keys().then(function(e){return e&&0!==e.length?Promise.all(e.map(function(e){if(0!==e.indexOf(r))return caches.delete(e);caches.open(e).then(function(e){e.keys().then(function(t){if(!(t.length<i)){var n=[],r=[],a=[];return t.forEach(function(t){r.push(t),a.push(e.match(t))}),Promise.all(a).then(function(t){var a=h();t.forEach(function(t,o){if(t&&t.headers){var i=t.headers.get("x-abtf-sw");if(i){var c=t.headers.get("x-abtf-sw-expire");if(c&&i&&i<h()-c)return void e.delete(r[o])}else i=a;!1!==n&&n.push({t:i,r:r[o]})}}),n&&n.length>i&&(n.sort(function(e,t){return e.t>t.t?-1:e.t<t.t?1:0}),n.slice(i).forEach(function(t){e.delete(t.r)}))})}})})})).then(function(){m=!1}):Promise.resolve()}))},x=function(e,n,r){return t(e).then(function(t){if(t.ok&&t.status<400&&n){var r=!0;n.conditions&&n.conditions.forEach(function(n){if(r)switch(n.type){case"url":if(n.regex)if(o=p(n.pattern)){c=o.test(e.url);n.not?c&&(r=!1):c||(r=!1)}else r=!1;else{c=-1!==e.url.indexOf(n.pattern);n.not?c&&(r=!1):c||(r=!1)}break;case"header":var a=t.headers.get(n.name);if(a)if(n.regex){var o=p(n.pattern);if(o){c=o.test(a);n.not?c&&(r=!1):c||(r=!1)}else r=!1}else if("object"==typeof n.pattern)if(n.pattern.operator){a=parseFloat(a);var i=parseFloat(n.pattern.value);if(isNaN(a)||isNaN(i))r=!1;else{switch(n.pattern.operator){case"<":c=a<i;break;case">":c=a>i;break;case"=":var c=a===i;break;default:r=!1}r&&(n.not?c&&(r=!1):c||(r=!1))}}else r=!1;else-1===a.indexOf(n.pattern)&&(r=!1);else r=!1}}),r&&N(e,t.clone(),n)}return t}).catch(function(t){return r?r(e,null,t):null})},y=function(e,n,r,a){var o=r.headers.get("etag"),i=l(r.headers.get("last-modified"));if(!o&&!i){var c=x(e,n);return a&&(c=c.then(a)),c}var s=new Request(e.url,{method:"HEAD",headers:e.headers,mode:"no-cors"});t(s).then(function(t){var r=!1,c=t.headers.get("etag"),s=l(t.headers.get("last-modified"));if(c&&c!==o?r=!0:s&&s!==i&&(r=!0),r){var u=x(e,n);return a&&(u=u.then(a)),u}return null}).catch(function(t){var r=x(e,n);return a&&(r=r.then(a)),r})},E=function(e,n){return e=new Request(e),q(e).then(function(e){return e?e.blob().then(function(t){return new Response(t,{status:503,statusText:"Offline",headers:e.headers})}):t(n).catch(function(e){throw e})})},q=function(e){return caches.open(r).then(function(t){return t.match(e).then(function(e){if(e){var t=e.headers.get("x-abtf-sw-expire");if(t)var n=e.headers.get("x-abtf-sw");var r=e.headers.get("expire");r&&(r=l(r)),t&&n<h()-t?e=!1:r&&r<h()&&(e=!1)}return e})})},b=function(e){if(e)return"string"==typeof e&&(e=new Request(e,{mode:"no-cors"})),q(e).then(function(t){return t||x(e,{conditions:null})})},N=function(e,t,n){caches.open(r).then(function(r){var a={};t.headers.forEach(function(e,t){a[t]=e}),a["x-abtf-sw"]=h(),n&&n.max_age&&(a["x-abtf-sw-expire"]=n.max_age),t.blob().then(function(n){var o=new Response(n,{status:t.status,statusText:t.statusText,headers:a});r.put(e,o)})})};e.addEventListener("fetch",function(n){if("GET"===n.request.method){var o=!1;if(["wp-admin/","wp-login.php"].forEach(function(t){if(!o){var r=new RegExp("^([^/]+)?//"+e.location.host+"(:[0-9]+)?/"+t);(r.test(n.request.url)||n.request.referrer&&r.test(n.request.referrer))&&(o=!0)}}),!(o||n.request.url.match(/\&preview=true/)||n.request.url.match(/\&preview_nonce=/))&&(u(),a&&r)){var i=function(e,n){if(!n||0===n.length)return!1;w();var r=!1;if(n.forEach(function(t){if(!r&&t.match&&0!==t.match.length){var n=!0;t.match.forEach(function(t){if(n)switch(t.type){case"url":if(t.regex)(o=p(t.pattern))?(i=o.test(e.request.url),t.not?i&&(n=!1):i||(n=!1)):n=!1;else if(t.pattern instanceof Array){var r=!1;t.pattern.forEach(function(t){r||-1!==e.request.url.indexOf(t)&&(r=!0)}),t.not?r&&(n=!1):r||(n=!1)}else i=-1!==e.request.url.indexOf(t.pattern),t.not?i&&(n=!1):i||(n=!1);break;case"header":switch(t.name.toLowerCase()){case"referer":case"referrer":a=e.request.referrer;break;default:var a=e.request.headers.get(t.name)}if(a)if(t.regex){var o=p(t.pattern);o?(i=o.test(a),t.not?i&&(n=!1):i||(n=!1)):n=!1}else{var i=-1!==a.indexOf(t.pattern);t.not?i&&(n=!1):i||(n=!1)}else t.not||(n=!1)}}),n&&(r=t)}}),!r)return!1;switch(r.strategy){case"never":return!1;case"cache":return q(e.request).then(function(n){if(n){var a=!0;if(r.cache.update_interval)o=!isNaN(parseInt(r.cache.update_interval))&&parseInt(r.cache.update_interval);else var o=!1;if(o){var i=n.headers.get("x-abtf-sw");i&&parseInt(i)>h()-o&&(a=!1)}return a&&function(e,t){setTimeout(function(){var n;if(r.cache.head_update&&(n=function(){clients.matchAll().then(function(t){t.forEach(function(t){t.postMessage([2,e.url])})})}),r.cache.head_update)y(e,r.cache,t,n);else{var a=x(e,r.cache);n&&a.then(n)}},10)}(e.request.clone(),n.clone()),n}return x(e.request,r.cache,function(n,a,o){return r.offline?E(r.offline,n.clone()):a||t(e.request.clone()).catch(function(e){throw e})})});case"event":return q(e.request).then(function(n){return n||x(e.request,null,function(n,a,o){return r.offline?E(r.offline,n.clone()):a||t(e.request).catch(function(e){throw e})})});case"network":default:return x(e.request,r.cache,function(n,a,o){return q(n).then(function(o){return o||(r.offline?E(r.offline,n.clone()):a||t(e.request).catch(function(e){throw e}))})})}}(n,a);if(!1!==i)return n.respondWith(i)}}}),e.addEventListener("message",function(t){if(t&&t.data&&t.data instanceof Array){if(1===t.data[0]){t.data[1]&&!isNaN(parseInt(t.data[1]))&&u(parseInt(t.data[1])),t.data[3]&&!isNaN(parseInt(t.data[3]))&&(i=parseInt(t.data[3])),t.data[4]&&b(t.data[4]);var n="abtf:"+(t.data[2]?t.data[2]+":":"");n!==r&&(r=n),g()}if(2===t.data[0]||3===t.data[0])if(t.ports[0])a=function(e,n){t.ports[0].postMessage({error:e,status:n})};else var a=!1;if(2===t.data[0])if(t.data[1]){var o;if("string"==typeof t.data[1]||t.data[1]instanceof Request?o=[t.data[1]]:t.data[1]instanceof Array&&(o=t.data[1]),o){var c=[];o.forEach(function(e){c.push(b(e))}),a&&Promise.all(c).then(function(e){var t=[];e.forEach(function(e){var n={url:e.url,status:e.status,statusText:e.statusText},r=e.headers.get("content-length");n.size=isNaN(parseInt(r))?-1:parseInt(r),t.push(n)}),a(null,t)}).catch(function(e){})}else a&&a("invalid-data")}else a&&a("no-urls");3===t.data[0]&&(e.registration.showNotification(t.data[1],t.data[2]),a&&a(null,"sent"))}})}(self,self.fetch,Cache);