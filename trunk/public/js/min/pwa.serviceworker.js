!function(t,e,n){var r,a,o,i=!1,u=!1,c=1e3,s=function(){var t=new URL(location);(r=t.searchParams.get("path"))||(r="/");var e=t.searchParams.get("config");e||(e="abtf-pwa-config.json"),a=r+e};t.addEventListener("install",function(e){e.waitUntil(v().then(function(){t.skipWaiting()}).catch(function(){t.skipWaiting()}))}),t.addEventListener("activate",function(e){e.waitUntil(t.clients.claim())}),n.prototype.add||(n.prototype.add=function(t){return this.addAll([t])}),n.prototype.addAll||(n.prototype.addAll=function(t){function n(t){this.name="NetworkError",this.code=19,this.message=t}var r=this;return n.prototype=Object.create(Error.prototype),Promise.resolve().then(function(){if(arguments.length<1)throw new TypeError;return t=t.map(function(t){return t instanceof Request?t:String(t)}),Promise.all(t.map(function(t){"string"==typeof t&&(t=new Request(t));var r=new URL(t.url).protocol;if("http:"!==r&&"https:"!==r)throw new n("Invalid scheme");return e(t.clone()).catch(function(t){setTimeout(function(){throw t})})}))}).then(function(e){return Promise.all(e.map(function(e,n){return r.put(t[n],e)}))}).then(function(){})}),CacheStorage.prototype.match||(CacheStorage.prototype.match=function(t,e){var n=this;return this.keys().then(function(r){var a;return r.reduce(function(r,o){return r.then(function(){return a||n.open(o).then(function(n){return n.match(t,e)}).then(function(t){return a=t})})},Promise.resolve())})});var f,h=function(){function t(){this.value=[],this.leftBits=0}function e(t){for(var e="",n=t.byteLength,r=0;r<n;r++)e+=String.fromCharCode(t[r]);return btoa(e).replace(/=+$/,"")}function n(t){return t>0&&(t&1+~t)===t}function r(t,e){return t-e}function a(t,e,n){return new Promise(function(r,a){var i=o(t);crypto.subtle.digest("SHA-256",u.encode(i)).then(function(t){var a=new DataView(t).getUint32(0),o=Math.log2(e*n);if(o>31)throw Error("This implementation only supports up to 31 bit hash values");r(a=a>>32-o&(1<<o)-1)})})}function o(t){return t.replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16)})}function o(t){return t.replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16)})}function i(o,i){if(i>=Math.pow(2,32))throw Error('Invalid probability: "${p}" must be smaller than 2**32');if(!n(i))throw Error('Invalid probability: "${p}" must be a power of 2');var u,c=Math.min(Math.pow(2,Math.round(Math.log2(o.length))),Math.pow(2,31)),s=[];return new Promise(function(n,f){Promise.all(o.map(function(t){return a(t,c,i)})).then(function(a){s=s.concat().sort(r),u=Uint8Array.from((new t).addBits(Math.log2(c),5).addBits(Math.log2(i),5).gcsEncode(s,Math.log2(i)).value),n(e(u))})})}t.prototype.addBit=function(t){return 0==this.leftBits&&(this.value.push(0),this.leftBits=8),--this.leftBits,t&&(this.value[this.value.length-1]|=1<<this.leftBits),this},t.prototype.addBits=function(t,e){if(0!=e)do{--e,this.addBit(t&1<<e)}while(0!=e);return this},t.prototype.gcsEncode=function(t,e){for(var n=-1,r=0;r!=t.length;++r)if(n!=t[r]){for(var a=t[r]-n-1,o=a>>e;0!=o;--o)this.addBit(0);this.addBit(1),this.addBits(a,e),n=t[r]}return this};var u=new TextEncoder("utf-8");return function(t,e){return i(t,e)}}(),l=function(t){return t&&t.includes("text/html")?new Promise(function(t,e){caches.open(o+":push").then(function(e){e.keys().then(function(e){if(0===e.length)return t(null);var n=[];e.forEach(function(t){n.push(N(t))}),Promise.all(n).then(function(n){var r=[];e.forEach(function(t,e){"undefined"!==n[e]&&n[e]&&r.push(t.url)}),0===r.length?t(null):h(r,Math.pow(2,7)).then(function(e){t(e)})})})})}):Promise.resolve(null)},d=function(){var t={},e=0,n=[],r=function(e,a,o){var i=!1,u=Object.keys(t);if(u.length>0){var c=Date.now();u.forEach(function(e){if(!i)if(t[e][0]<c-t[e][1])try{delete t[e]}catch(t){}else i=!0})}if(i){if(0===a)return;var s;if(o){var f=!1;n.forEach(function(t,e){f||t[2]==o&&(f=e)}),f&&(n[f][1]&&clearTimeout(n[f][1]),s=f)}s||(s=n.push([])-1),n[s]=[e,setTimeout(function(t,e){delete n[t],e(),n.length>0&&r(null,0)},a,s,e),o]}else if(e&&n.push([e]),n.length>0)for(var h=n.shift();h;){if(h instanceof Array){h[1]&&clearTimeout(h[1]);try{h[0]()}catch(t){}}h=n.shift()}};return{start:function(n){var r=++e;return t[r]=[Date.now(),n],r},complete:function(e){try{delete t[e]}catch(t){}n.length>0&&r(null,0)},onIdle:r}}(),p=function(t){return new Promise(function(n,r){if(!i||!u||t&&t>u){var o=!i;v().then(function(){o&&n(i?i:!1)}).catch(function(){o&&n(!1)})}else if(!f&&u<m()-300){s(),f=!0;var c=new Request(a+"?"+Math.round(Date.now()/1e3),{method:"HEAD",mode:"no-cors"});e(c).then(function(t){f=!1;var e=!0;if(t&&t.ok){var n=g(t.headers.get("last-modified"));n&&n<=u&&(e=!1)}e&&v()}).catch(function(t){f=!1,v()})}else n(i)}).catch(function(t){setTimeout(function(){throw t})})},v=function(){return f?Promise.resolve():(s(),f=!0,e(a+"?"+Math.round(Date.now()/1e3),{mode:"no-cors"}).then(function(t){if(f=!1,t&&t.ok&&t.status<400)return t.json().then(function(t){if(t){t instanceof Array&&(t={policy:t}),t.policy&&(i=t.policy,u=m());var e=[];t.start_url&&e.push(t.start_url),t.policy&&t.policy.forEach(function(t){t.offline&&-1===e.indexOf(t.offline)&&e.push(t.offline)}),t.preload&&t.preload.forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),preloadPromises=[],e.forEach(function(t){preloadPromises.push(I(t))})}});throw i=!1,new Error("service worker config not found: "+a)}).catch(function(t){f=!1,i=!1,setTimeout(function(){throw t})}))},m=function(){return Math.round(Date.now()/1e3)},g=function(t){if(t)return isNaN(parseInt(t))?(t=Date.parse(t),isNaN(t)?void 0:Math.round(t/1e3)):t},w=/^\/(.*)\/([gimuy]+)?$/,y=function(t){var e=t.match(w);if(e){try{var n=new RegExp(e[1],e[2])}catch(t){}return n||!1}},E=!1,x=!1,b=!1,q=function(){x||(!E||E<m()-10)&&(x=!0,E=m(),caches.keys().then(function(t){return t&&0!==t.length?Promise.all(t.map(function(t){if(0!==t.indexOf(o))return caches.delete(t);caches.open(t).then(function(t){t.keys().then(function(e){if(!(e.length<c)){var n=[],r=[],a=[];return e.forEach(function(e){r.push(e),a.push(t.match(e))}),Promise.all(a).then(function(e){var a=m();e.forEach(function(e,o){if(e&&e.headers){var i=e.headers.get("x-abtf-sw");if(i){var u=e.headers.get("x-abtf-sw-expire");if(u&&i&&i<m()-u)return void t.delete(r[o])}else i=a;!1!==n&&n.push({t:i,r:r[o]})}}),n&&n.length>c&&(n.sort(function(t,e){return t.t>e.t?-1:t.t<e.t?1:0}),n.slice(c).forEach(function(e){t.delete(e.r)}))})}})})})).then(function(){x=!1}):Promise.resolve()}))},T=function(t,n,r){var a=d.start(1e3);return l(t.headers.get("accept")).then(function(i){var u=t;return i&&(u=new Request(u)).headers.set("cache-digest",i),e(u).then(function(t){var e=!1;if(t.ok&&t.status<400){var r=t.headers.get("link");r&&(r instanceof Array||(r=[r]),d.onIdle(function(){caches.open(o+":push").then(function(t){r.forEach(function(e){e.split(",").forEach(function(e){if(/rel=preload/.test(e)){var n=e.match(/<([^>]+)>/);n&&n[1]&&t.match(n[1]).then(function(e){e||t.put(n[1],new Response(null,{status:204}))})}})})})},1e3)),n&&(e=!0,n.conditions&&n.conditions.forEach(function(n){if(e)switch(n.type){case"url":if(n.regex)if(a=y(n.pattern)){i=a.test(u.url);n.not?i&&(e=!1):i||(e=!1)}else e=!1;else{i=-1!==u.url.indexOf(n.pattern);n.not?i&&(e=!1):i||(e=!1)}break;case"header":var r=t.headers.get(n.name);if(r)if(n.regex){var a=y(n.pattern);if(a){i=a.test(r);n.not?i&&(e=!1):i||(e=!1)}else e=!1}else if("object"==typeof n.pattern)if(n.pattern.operator){r=parseFloat(r);var o=parseFloat(n.pattern.value);if(isNaN(r)||isNaN(o))e=!1;else{switch(n.pattern.operator){case"<":i=r<o;break;case">":i=r>o;break;case"=":var i=r===o;break;default:e=!1}e&&(n.not?i&&(e=!1):i||(e=!1))}}else e=!1;else-1===r.indexOf(n.pattern)&&(e=!1);else e=!1}}),e&&M(u,t.clone(),n).then(function(){d.complete(a)}))}return e||d.complete(a),t}).catch(function(t){return d.complete(a),r?r(u,null,t):null})})},k=function(t,n,r,a){var o=r.headers.get("etag"),i=g(r.headers.get("last-modified"));if(!o&&!i){var u=T(t,n);return a&&(u=u.then(a)),u}var c=d.start(1e3),s=new Request(t.url,{method:"HEAD",headers:t.headers,mode:"no-cors"});e(s).then(function(e){var r=!1,u=e.headers.get("etag"),s=g(e.headers.get("last-modified"));if(u&&u!==o?r=!0:s&&s!==i&&(r=!0),r){var f=T(t,n);return f=f.then(function(t){return d.complete(c),t}),a&&(f=f.then(a)),f}return d.complete(c),null}).catch(function(e){var r=T(t,n);return r=r.then(function(t){return d.complete(c),t}),a&&(r=r.then(a)),r})},P=function(t,n){return t=new Request(t),N(t).then(function(t){return t?t.blob().then(function(e){return new Response(e,{status:503,statusText:"Offline",headers:t.headers})}):e(n).catch(function(t){setTimeout(function(){throw t})})})},N=function(t){var e=d.start(1e3);return caches.open(o).then(function(n){return n.match(t).then(function(t){if(t){var n=t.headers.get("x-abtf-sw-expire");if(n)var r=t.headers.get("x-abtf-sw");var a=t.headers.get("expire");a&&(a=g(a)),n&&r<m()-n?t=!1:a&&a<m()&&(t=!1)}return d.complete(e),t})})},I=function(t){if(t)return"string"==typeof t&&(t=new Request(t,{mode:"no-cors"})),N(t).then(function(e){return e||T(t,{conditions:null})})},M=function(t,e,n){return caches.open(o).then(function(r){var a={};return e.headers.forEach(function(t,e){a[e]=t}),a["x-abtf-sw"]=m(),n&&n.max_age&&(a["x-abtf-sw-expire"]=n.max_age),e.blob().then(function(n){var o=new Response(n,{status:e.status,statusText:e.statusText,headers:a});return r.put(t,o)})})};t.addEventListener("fetch",function(n){if("GET"===n.request.method){var r=!1;if(["wp-admin/","wp-login.php"].forEach(function(e){if(!r){var a=new RegExp("^([^/]+)?//"+t.location.host+"(:[0-9]+)?/"+e);(a.test(n.request.url)||n.request.referrer&&a.test(n.request.referrer))&&(r=!0)}}),!(r||n.request.url.match(/\&preview=true/)||n.request.url.match(/\&preview_nonce=/))&&(p(),i&&o)){var a=function(t,n){if(!n||0===n.length)return!1;var r=!1;if(n.forEach(function(e){if(!r&&e.match&&0!==e.match.length){var n=!0;e.match.forEach(function(e){if(n)switch(e.type){case"url":if(e.regex)(o=y(e.pattern))?(i=o.test(t.request.url),e.not?i&&(n=!1):i||(n=!1)):n=!1;else if(e.pattern instanceof Array){var r=!1;e.pattern.forEach(function(e){r||-1!==t.request.url.indexOf(e)&&(r=!0)}),e.not?r&&(n=!1):r||(n=!1)}else i=-1!==t.request.url.indexOf(e.pattern),e.not?i&&(n=!1):i||(n=!1);break;case"header":switch(e.name.toLowerCase()){case"referer":case"referrer":a=t.request.referrer;break;default:var a=t.request.headers.get(e.name)}if(a)if(e.regex){var o=y(e.pattern);o?(i=o.test(a),e.not?i&&(n=!1):i||(n=!1)):n=!1}else{var i=-1!==a.indexOf(e.pattern);e.not?i&&(n=!1):i||(n=!1)}else e.not||(n=!1)}}),n&&(r=e)}}),!r)return!1;switch(b&&clearTimeout(b),b=setTimeout(function(){d.onIdle(q,1e4,"clean-cache"),b=!1},100),r.strategy){case"never":return!1;case"cache":return N(t.request).then(function(n){if(n){var a=!0;if(r.cache.update_interval)o=!isNaN(parseInt(r.cache.update_interval))&&parseInt(r.cache.update_interval);else var o=!1;if(o){var i=n.headers.get("x-abtf-sw");i&&parseInt(i)>m()-o&&(a=!1)}return a&&function(t,e){setTimeout(function(){var n;if(r.cache.notify&&(n=function(){clients.matchAll().then(function(e){e.forEach(function(e){e.postMessage([2,t.url])})})}),r.cache.head_update)k(t,r.cache,e,n);else{var a=T(t,r.cache);n&&a.then(n)}},10)}(t.request.clone(),n.clone()),n}return T(t.request,r.cache,function(n,a,o){return r.offline?P(r.offline,n.clone()):a||e(t.request.clone()).catch(function(t){setTimeout(function(){throw t})})})});case"event":return N(t.request).then(function(n){return n||T(t.request,null,function(n,a,o){return r.offline?P(r.offline,n.clone()):a||e(t.request).catch(function(t){setTimeout(function(){throw t})})})});case"network":default:return T(t.request,r.cache,function(n,a,o){return N(n).then(function(o){return o||(r.offline?P(r.offline,n.clone()):a||e(t.request).catch(function(t){setTimeout(function(){throw t})}))})})}}(n,i);if(!1!==a)return n.respondWith(a)}}}),t.addEventListener("message",function(e){if(e&&e.data&&e.data instanceof Array){if(1===e.data[0]){e.data[1]&&!isNaN(parseInt(e.data[1]))&&p(parseInt(e.data[1])),e.data[3]&&!isNaN(parseInt(e.data[3]))&&(c=parseInt(e.data[3]));var n="abtf:"+(e.data[2]?e.data[2]+":":"");n!==o&&(o=n),d.onIdle(q,1e4,"clean-cache")}if(2===e.data[0]||3===e.data[0])if(e.ports[0])r=function(t,n){e.ports[0].postMessage({error:t,status:n})};else var r=!1;if(2===e.data[0])if(e.data[1]){var a;if("string"==typeof e.data[1]||e.data[1]instanceof Request?a=[e.data[1]]:e.data[1]instanceof Array&&(a=e.data[1]),a){var i=[];a.forEach(function(t){i.push(I(t))}),r&&Promise.all(i).then(function(t){var e=[];t.forEach(function(t){var n={url:t.url,status:t.status,statusText:t.statusText},r=t.headers.get("content-length");n.size=isNaN(parseInt(r))?-1:parseInt(r),e.push(n)}),r(null,e)}).catch(function(t){})}else r&&r("invalid-data")}else r&&r("no-urls");3===e.data[0]&&(t.registration.showNotification(e.data[1],e.data[2]),r&&r(null,"sent"))}})}(self,self.fetch,Cache);